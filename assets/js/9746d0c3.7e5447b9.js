"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[767],{3905:(e,t,a)=>{a.d(t,{Zo:()=>d,kt:()=>c});var n=a(7294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function l(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function r(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?l(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):l(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function o(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},l=Object.keys(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(n=0;n<l.length;n++)a=l[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var s=n.createContext({}),m=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):r(r({},t),e)),a},d=function(e){var t=m(e.components);return n.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},u=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,l=e.originalType,s=e.parentName,d=o(e,["components","mdxType","originalType","parentName"]),u=m(a),c=i,b=u["".concat(s,".").concat(c)]||u[c]||p[c]||l;return a?n.createElement(b,r(r({ref:t},d),{},{components:a})):n.createElement(b,r({ref:t},d))}));function c(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var l=a.length,r=new Array(l);r[0]=u;var o={};for(var s in t)hasOwnProperty.call(t,s)&&(o[s]=t[s]);o.originalType=e,o.mdxType="string"==typeof e?e:i,r[1]=o;for(var m=2;m<l;m++)r[m]=a[m];return n.createElement.apply(null,r)}return n.createElement.apply(null,a)}u.displayName="MDXCreateElement"},4896:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>r,default:()=>p,frontMatter:()=>l,metadata:()=>o,toc:()=>m});var n=a(7462),i=(a(7294),a(3905));const l={title:"Tables",displayed_sidebar:"dynamodb"},r=void 0,o={unversionedId:"dynamo-db/table",id:"dynamo-db/table",title:"Tables",description:"Create a table",source:"@site/docs/dynamo-db/03-table.md",sourceDirName:"dynamo-db",slug:"/dynamo-db/table",permalink:"/tutorials/dynamo-db/table",draft:!1,tags:[],version:"current",sidebarPosition:3,frontMatter:{title:"Tables",displayed_sidebar:"dynamodb"},sidebar:"dynamodb",previous:{title:"Setup",permalink:"/tutorials/dynamo-db/setup"},next:{title:"Primary Key",permalink:"/tutorials/dynamo-db/primary-key"}},s={},m=[{value:"Create a table",id:"create-a-table",level:2},{value:"Table operations",id:"table-operations",level:2},{value:"Create",id:"create",level:3},{value:"Describe",id:"describe",level:3},{value:"Update",id:"update",level:3},{value:"Delete",id:"delete",level:3},{value:"List all tables",id:"list-all-tables",level:3},{value:"Get provisioned capacity quota",id:"get-provisioned-capacity-quota",level:2}],d={toc:m};function p(e){let{components:t,...a}=e;return(0,i.kt)("wrapper",(0,n.Z)({},d,a,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"create-a-table"},"Create a table"),(0,i.kt)("p",null,"To create a table in DynamoDB, you can use this code."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts",metastring:"showLineNumbers",showLineNumbers:!0},"import { CreateTableCommand, DynamoDBClient, TableClass } from \"@aws-sdk/client-dynamodb\";\nconst endpoint = 'http://localhost:8000';\nconst client = new DynamoDBClient({\n  endpoint\n});\n\nasync function createMyTable() {\n  const command = new CreateTableCommand({\n    TableName: 'User',\n    AttributeDefinitions: [\n      {\n        AttributeName: 'Username',\n        AttributeType: 'S'\n      },\n      {\n        AttributeName: 'State',\n        AttributeType: 'S'\n      }\n    ],\n    KeySchema: [\n      {\n        AttributeName: 'Username',\n        KeyType: 'HASH'\n      },\n      {\n        AttributeName: 'State',\n        KeyType: 'RANGE'\n      }\n    ],\n    BillingMode: 'PROVISIONED',\n    ProvisionedThroughput: {\n      ReadCapacityUnits: 10,\n      WriteCapacityUnits: 10\n    },\n    TableClass: TableClass.STANDARD\n  });\n  const result = await client.send(command);\n  console.log(result);\n}\ncreateMyTable();\n")),(0,i.kt)("p",null,"On ",(0,i.kt)("strong",{parentName:"p"},"line 3"),", we are initializing ",(0,i.kt)("inlineCode",{parentName:"p"},"client")," with the instance of class ",(0,i.kt)("inlineCode",{parentName:"p"},"DynamoDBClient"),". This class is imported from ",(0,i.kt)("inlineCode",{parentName:"p"},"@aws-sdk/client-dynamodb"),". While calling the constructor of the ",(0,i.kt)("inlineCode",{parentName:"p"},"DynamoDBClient")," class we are passing the endpoint URL of our local DynamoDB instance.\nNext, we are creating the ",(0,i.kt)("inlineCode",{parentName:"p"},"CreateTableCommand")," command for creating ",(0,i.kt)("inlineCode",{parentName:"p"},"MyTable")," inside the ",(0,i.kt)("inlineCode",{parentName:"p"},"createMyTable")," function."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"TableName"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"AttributeDefinitions")," & ",(0,i.kt)("inlineCode",{parentName:"p"},"KeySchema")," are the required parameters required for creating a table. The default value for ",(0,i.kt)("inlineCode",{parentName:"p"},"BillingMode")," is ",(0,i.kt)("inlineCode",{parentName:"p"},"PROVISIONED"),". For the provisioned billing mode we need to specify ",(0,i.kt)("inlineCode",{parentName:"p"},"ProvisionedThroughput"),". If we know how frequently our table is going to be accessed, then we can also specify ",(0,i.kt)("inlineCode",{parentName:"p"},"TableClass")," also. By default table class is set to ",(0,i.kt)("inlineCode",{parentName:"p"},"STANDARD"),".Now the only thing remaining is to call client.send to create our table which we are doing at ",(0,i.kt)("strong",{parentName:"p"},"line 37"),"."),(0,i.kt)("p",null,"Here are the inputs parameters of ",(0,i.kt)("inlineCode",{parentName:"p"},"CreateTableCommand")," in detail."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"TableName:")," This field is used to give a to our table."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"AttributeDefinitions:")," This field is used to define the attributes of our table. As DynamoDB is schemaless there we only need to specify only those attributes that we are going to use in our primary key. Other attribute definitions are optional. It is an array of objects where each object contains ",(0,i.kt)("inlineCode",{parentName:"li"},"AttributeName")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"AttributeType"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"KeySchema:")," This field is used to define those attributes we are going to use in our primary key. It is an array with at least one element and at most two elements, depending on our primary key type. Every attribute in KeySchema should be present in AttributeDefinitions. ",(0,i.kt)("inlineCode",{parentName:"li"},"HASH")," key type is used for the ",(0,i.kt)("strong",{parentName:"li"},"partition key")," attribute and ",(0,i.kt)("inlineCode",{parentName:"li"},"RANGE")," is used for the ",(0,i.kt)("strong",{parentName:"li"},"sort key")," type."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"BillingMode"),": This field is used to specify how we want to be billed to access our table. We can set these two billing modes. This field can be updated later. These are the two modes which we can choose from.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"PROVISIONED: This mode should be used if we can predict how much traffic our table is going to get."),(0,i.kt)("li",{parentName:"ul"},"PAY_PER_REQUEST: Also know as ",(0,i.kt)("strong",{parentName:"li"},"On-demand mode"),". This mode should be used if we can not predict how much traffic our table is going to get."))),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"ProvisionedThroughput:")," This field is used when billing mode is provisioned. This field requires ",(0,i.kt)("inlineCode",{parentName:"li"},"ReadCapacityUnits")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"WriteCapacityUnits")," to be specified. More info on read/write capacity can be found ",(0,i.kt)("a",{parentName:"li",href:"https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/HowItWorks.ReadWriteCapacityMode.html"},"here"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"TableClass:")," This field is used to optimize the cost of our table. Based on how frequently our tables are going to be accessed, we can set either of these two classes.",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"STANDARD: Should be used where data is accessed more frequently."),(0,i.kt)("li",{parentName:"ul"},"STANDARD_INFREQUENT_ACCESS: Should be used data is accessed less frequently such as application logs, e-commerce order history, etc.")))),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"table-operations"},"Table operations"),(0,i.kt)("p",null,"These are the basic operations we can perform on tables."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Create"),(0,i.kt)("li",{parentName:"ul"},"Describe"),(0,i.kt)("li",{parentName:"ul"},"Update"),(0,i.kt)("li",{parentName:"ul"},"Delete"),(0,i.kt)("li",{parentName:"ul"},"List all tables")),(0,i.kt)("h3",{id:"create"},"Create"),(0,i.kt)("p",null,"We have already seen above how we can create a table."),(0,i.kt)("h3",{id:"describe"},"Describe"),(0,i.kt)("p",null,"This operation is used to get details of a table. Have a look at this code."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts",metastring:"showLineNumbers",showLineNumbers:!0},"async function describeMyTable() {\n  const command = new DescribeTableCommand({\n    TableName: 'MyTable'\n  });\n  const result = await client.send(command);\n  console.log(result);\n}\ndescribeMyTable();\n")),(0,i.kt)("p",null,"In the above code, ",(0,i.kt)("inlineCode",{parentName:"p"},"result")," will contain a field ",(0,i.kt)("inlineCode",{parentName:"p"},"Table")," that has all the information about our table such as:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"TableStatus"),(0,i.kt)("li",{parentName:"ul"},"TableName"),(0,i.kt)("li",{parentName:"ul"},"TableArn"),(0,i.kt)("li",{parentName:"ul"},"TableSizeBytes"),(0,i.kt)("li",{parentName:"ul"},"AttributeDefinitions"),(0,i.kt)("li",{parentName:"ul"},"BillingModeSummary"),(0,i.kt)("li",{parentName:"ul"},"KeySchema"),(0,i.kt)("li",{parentName:"ul"},"ItemCount"),(0,i.kt)("li",{parentName:"ul"},"ProvisionedThroughput etc.")),(0,i.kt)("h3",{id:"update"},"Update"),(0,i.kt)("p",null,"To update a table we have to use ",(0,i.kt)("inlineCode",{parentName:"p"},"UpdateTableCommand"),". We can make any of these changes with this command."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Change the table's provisioned throughput (depends on table billing mode)."),(0,i.kt)("li",{parentName:"ul"},"Change the table's billing mode"),(0,i.kt)("li",{parentName:"ul"},"Add, update or delete the global secondary index."),(0,i.kt)("li",{parentName:"ul"},"Enable or disable streams on the table.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts",metastring:"showLineNumbers",showLineNumbers:!0},"async function updateMyTable() {\n  const command = new UpdateTableCommand({\n    TableName: 'MyTable',\n    BillingMode: 'PROVISIONED',\n    ProvisionedThroughput: {\n      ReadCapacityUnits: 10,\n      WriteCapacityUnits: 10\n    },\n    StreamSpecification: {\n      StreamEnabled: true,\n      StreamViewType: 'KEYS_ONLY'\n    },\n  });\n  const result = await client.send(command);\n  console.log(result);\n}\n")),(0,i.kt)("p",null,"In the above code ",(0,i.kt)("inlineCode",{parentName:"p"},"result")," will be similar to ",(0,i.kt)("inlineCode",{parentName:"p"},"describe")," table operation."),(0,i.kt)("h3",{id:"delete"},"Delete"),(0,i.kt)("p",null,"To delete a table we use ",(0,i.kt)("inlineCode",{parentName:"p"},"DeleteTableCommand"),". Only the table name is required to delete a table."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts",metastring:"showLineNumbers",showLineNumbers:!0},"async function deleteMyTable() {\n  const command = new DeleteTableCommand({\n    TableName: 'MyTable'\n  });\n  const result = await client.send(command);\n  console.log(result);\n}\ndeleteMyTable();\n")),(0,i.kt)("p",null,"In the above code ",(0,i.kt)("inlineCode",{parentName:"p"},"result")," will be similar to ",(0,i.kt)("inlineCode",{parentName:"p"},"describe")," table operation."),(0,i.kt)("h3",{id:"list-all-tables"},"List all tables"),(0,i.kt)("p",null,"To list all tables we use ",(0,i.kt)("inlineCode",{parentName:"p"},"ListTablesCommand"),". We can pass any of these two optional parameters to this command."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"Limit:")," If no limit is provided then 100 is the default limit."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"ExclusiveStartTableName:")," When there are more tables than the limit, in that case, we can provide a table name to start counting after that table name.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts",metastring:"showLineNumbers",showLineNumbers:!0},"async function listAllTables() {\n  const command = new ListTablesCommand({\n    Limit: 2,\n    ExclusiveStartTableName: 'MyOtherTable'\n  });\n  const result = await client.send(command);\n  console.log(result);\n}\nlistAllTables();\n")),(0,i.kt)("p",null,"In the above code ",(0,i.kt)("inlineCode",{parentName:"p"},"result")," will contain all table names inside ",(0,i.kt)("inlineCode",{parentName:"p"},"TableNames")," array. This result also contains one more important field ",(0,i.kt)("inlineCode",{parentName:"p"},"LastEvaluatedTableName"),". This field should be used with ",(0,i.kt)("inlineCode",{parentName:"p"},"ExclusiveStartTableName")," in ",(0,i.kt)("inlineCode",{parentName:"p"},"ListTablesCommand")," to get the list of all tables in case we have more tables than the provided limit."),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"get-provisioned-capacity-quota"},"Get provisioned capacity quota"),(0,i.kt)("p",null,"At the time of creating our AWS account, we are given a quota for maximum read/write capacity units. This quota is applicable across a single region for all DynamoDB tables in that region. If you want to get that quota, you can use ",(0,i.kt)("inlineCode",{parentName:"p"},"DescribeLimitsCommand"),"."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts",metastring:"showLineNumbers",showLineNumbers:!0},"async function getProvisionedQuota() {\n  const command = new DescribeLimitsCommand({});\n  const result = await client.send(command);\n  console.log(result);\n}\ngetProvisionedQuota();\n")),(0,i.kt)("p",null,"In the above code ",(0,i.kt)("inlineCode",{parentName:"p"},"result")," will contain these important fields"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"AccountMaxReadCapacityUnits"),(0,i.kt)("li",{parentName:"ul"},"AccountMaxWriteCapacityUnits"),(0,i.kt)("li",{parentName:"ul"},"TableMaxReadCapacityUnits"),(0,i.kt)("li",{parentName:"ul"},"TableMaxWriteCapacityUnits")))}p.isMDXComponent=!0}}]);